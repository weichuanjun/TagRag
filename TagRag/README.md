## 代码分析与检索功能

TagRag系统支持代码分析和检索功能，允许用户在聊天中查询代码库内容。以下是使用步骤：

1. **添加代码库**：
   - 在"代码分析"页面中选择知识库，然后点击"添加代码库"按钮
   - 输入代码库本地路径，系统将分析代码结构
   - 代码库会自动进行向量化，使其可被检索
   - **重要**：代码库将与选中的知识库关联，便于后续检索

2. **向量化代码库**：
   - 如果代码库未自动向量化，可以点击"向量化代码库"按钮手动触发
   - 向量化过程会将代码组件存储到向量数据库中，使其可被检索
   - 系统会自动关联代码库和知识库，确保检索时使用正确的路径

3. **在聊天中使用代码检索**：
   - 在聊天页面中，开启"启用代码分析"开关
   - 选择要查询的代码库
   - 发送查询，系统会自动从代码库中检索相关内容

### 常见问题

1. **没有检索到代码内容？**
   - 确认代码库已成功向量化（在代码分析页面可以看到组件列表）
   - 检查是否选择了正确的代码库
   - 使用更精确的关键词进行查询
   - 检查代码库是否正确关联到知识库（查看后端日志）

2. **向量化失败？**
   - 检查代码库路径是否正确
   - 查看后端日志文件查找详细错误信息
   - 可以尝试使用命令行工具手动向量化：
     ```
     python TagRag/backend/utils/vectorize_repo.py --repo-id [仓库ID] --kb-id [知识库ID]
     ```

3. **修复代码检索问题**：
   - 如果之前的代码库无法被检索，请运行修复脚本：
     ```
     python TagRag/backend/fix_repository_kb_links.py
     ``` 